============ Initialized logger ============
BKG_file_name: BKG_file	 MLP_dropout: 0.2	 MLP_hidden_dim: 32	 MLP_num_layers: 2	 add_traspose_rels: False	 batch_size: 256	 dataset: drugbank	 disable_cuda: False	 early_stop_epoch: 10	 edge_softmax: 1	 emb_dim: 32	 enclosing_subgraph: True	 eval_every_iter: 526	 exp_dir: utils/../experiments/Drugbank	 experiment_name: Drugbank	 func_num: 1	 gcn_aggregator_type: mean	 gcn_dropout: 0.2	 gpu: 3	 gsl_has_edge_emb: 1	 gsl_rel_emb_dim: 32	 hop: 2	 kge_model: TransE	 lamda: 0.5	 load_model: False	 lr: 0.005	 lr_decay_rate: 0.93	 main_dir: utils/..	 max_links: 250000	 max_nodes_per_hop: 200	 num_dig_layers: 4	 num_epochs: 50	 num_gcn_layers: 2	 num_infer_layers: 3	 num_workers: 32	 optimizer: Adam	 save_every_epoch: 10	 seed: 1111	 sparsify: 1	 test_file: test	 threshold: 0.05	 train_file: train	 use_pre_embeddings: False	 valid_file: valid	 weight_decay_rate: 1e-05
============================================
Device: cuda:3
 # Relations : 86, # Augmented relations : 110
No existing model found. Initializing new model..
Total number of parameters: 1190553
start training...
Eval Performance:{'auc': 0.7681637967750078, 'auc_pr': 0.8939346650020807, 'k': 0.8738254052065593}in 81.10601019859314s
Test Performance:{'auc': 0.752262349918816, 'auc_pr': 0.8956505895520446, 'k': 0.875856014802758}in 123.2514865398407s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.85271318, 0.99019608, 0.82263433, 0.90909091,
       0.91064491, 0.85714286, 0.77777778, 0.91393939, 0.91385768,
       0.52892562, 0.88636364, 0.94117647, 0.94520548, 0.88      ,
       0.97289848, 0.85714286, 0.60869565, 0.38461538, 0.90553746,
       0.89940828, 1.        , 0.9       , 0.98630137, 0.88888889,
       0.        , 0.97560976, 0.        , 1.        , 0.66367713,
       0.5       , 0.95305164, 0.65088757, 0.91935484, 0.375     ,
       0.48      , 0.92394822, 0.66666667, 1.        , 0.97560976,
       0.        , 0.        , 0.66666667, 0.        , 1.        ,
       0.83333333, 0.90021647, 0.46666667, 0.93563284, 1.        ,
       0.90909091, 0.        , 0.73015873, 0.78388278, 0.8627451 ,
       0.8       , 0.84476534, 0.94660194, 1.        , 0.88305344,
       0.95287958, 0.        , 0.25      , 0.74534161, 1.        ,
       0.91304348, 0.92341357, 0.59259259, 0.92561983, 0.88064734,
       0.7987013 , 0.91891892, 0.83680632, 0.98823529, 0.82133189,
       0.93449782, 0.77419355, 1.        , 0.        , 0.        ,
       0.84210526, 0.71794872, 0.92578125, 1.        , 0.86363636,
       0.90909091])}in 123.62248969078064s
Epoch 1 with loss: 0.7712814365682148, training auc: 0.515462867054562, training auc_pr: 0.7860310009581035, best validation AUC: 0.7681637967750078 in 655.1911447048187
Eval Performance:{'auc': 0.8244402876193675, 'auc_pr': 0.9083437369954224, 'k': 0.8909732661205154}in 72.09034967422485s
Test Performance:{'auc': 0.8411033493757593, 'auc_pr': 0.9062703349904995, 'k': 0.8884095518364146}in 81.63339400291443s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([0.8       , 0.88709677, 0.98536585, 0.84257871, 0.88135593,
       0.91414554, 0.85714286, 0.83018868, 0.93990385, 0.90252708,
       0.59183673, 0.97826087, 0.875     , 0.8961039 , 0.90243902,
       0.97955475, 0.9375    , 0.82758621, 0.74285714, 0.92444444,
       0.91764706, 1.        , 0.83333333, 0.98591549, 0.92647059,
       0.        , 0.98113208, 0.        , 0.96969697, 0.68899522,
       0.66666667, 0.99509804, 0.68493151, 0.92913386, 0.72727273,
       0.94117647, 0.91764706, 0.83333333, 1.        , 1.        ,
       0.        , 1.        , 1.        , 1.        , 1.        ,
       0.75      , 0.90244433, 0.86956522, 0.9411099 , 0.88888889,
       0.94117647, 0.66666667, 0.77777778, 0.83408072, 0.95833333,
       0.66666667, 0.8683274 , 0.95308642, 1.        , 0.89193825,
       0.95145631, 0.        , 0.8       , 0.8       , 1.        ,
       0.96153846, 0.9321267 , 0.88888889, 0.95726496, 0.88732394,
       0.85521886, 0.94354839, 0.85122732, 1.        , 0.82594048,
       0.94835681, 0.82828283, 1.        , 0.57142857, 0.28571429,
       0.86486486, 0.81481481, 0.98951782, 1.        , 0.97297297,
       1.        ])}in 82.07706809043884s
Epoch 2 with loss: 0.31819100215321494, training auc: 0.7811106303523508, training auc_pr: 0.8983741950817359, best validation AUC: 0.8244402876193675 in 825.5535883903503
Eval Performance:{'auc': 0.8971811972569218, 'auc_pr': 0.916146483562214, 'k': 0.9004713224646703}in 54.857964515686035s
Test Performance:{'auc': 0.8464196874212163, 'auc_pr': 0.9155626122491476, 'k': 0.8996951043903372}in 130.37217450141907s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.92086331, 0.99019608, 0.85312651, 0.95      ,
       0.93111639, 1.        , 0.83018868, 0.94431555, 0.93129771,
       0.65079365, 0.94505495, 0.94117647, 0.96503497, 0.90243902,
       0.98402556, 0.9375    , 0.74074074, 0.48275862, 0.93139629,
       0.92397661, 1.        , 0.91666667, 1.        , 0.97508897,
       0.        , 0.98659517, 0.        , 0.99224806, 0.71304348,
       1.        , 0.99509804, 0.77575758, 0.9516129 , 0.26666667,
       1.        , 0.95510204, 0.90909091, 1.        , 0.99173554,
       0.        , 0.        , 1.        , 1.        , 1.        ,
       1.        , 0.90893309, 0.83333333, 0.94716658, 1.        ,
       1.        , 0.66666667, 0.848     , 0.84859155, 0.95833333,
       0.90909091, 0.88188976, 0.96039604, 1.        , 0.89707161,
       0.96517413, 0.        , 0.72727273, 0.82997118, 1.        ,
       0.95833333, 0.96055684, 0.79166667, 0.96551724, 0.90849459,
       0.9       , 0.96747967, 0.8585968 , 1.        , 0.84673098,
       0.97757848, 0.83653846, 1.        , 0.58823529, 0.35294118,
       0.81081081, 0.83916084, 0.99376299, 1.        , 0.96      ,
       0.90909091])}in 130.70886063575745s
Epoch 3 with loss: 0.26188524575460526, training auc: 0.8570848258522967, training auc_pr: 0.9139043827660223, best validation AUC: 0.8971811972569218 in 860.9619133472443
Eval Performance:{'auc': 0.8807170908481045, 'auc_pr': 0.9168227215980025, 'k': 0.901758589166945}in 83.23277592658997s
Test Performance:{'auc': 0.866031317124982, 'auc_pr': 0.9154064395221114, 'k': 0.9000023599945185}in 123.11458373069763s
Epoch 4 with loss: 0.2348318886756897, training auc: 0.8757235467168597, training auc_pr: 0.922222799890078, best validation AUC: 0.8971811972569218 in 896.7978324890137
Eval Performance:{'auc': 0.8640136879372912, 'auc_pr': 0.922180607573866, 'k': 0.9076164976839672}in 82.54119300842285s
Test Performance:{'auc': 0.8705239324448159, 'auc_pr': 0.9196751607277649, 'k': 0.904578737900533}in 137.85643672943115s
Epoch 5 with loss: 0.21851612692787534, training auc: 0.8939808811144225, training auc_pr: 0.9273995291181735, best validation AUC: 0.8971811972569218 in 869.4490263462067
Eval Performance:{'auc': 0.9147732598613045, 'auc_pr': 0.9253537245110279, 'k': 0.9114848986103056}in 73.92033338546753s
Test Performance:{'auc': 0.9048023574248774, 'auc_pr': 0.9226684713292902, 'k': 0.9082411929837916}in 148.13786602020264s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.96240602, 0.99019608, 0.87251575, 0.93442623,
       0.94588235, 1.        , 0.84444444, 0.95724466, 0.92481203,
       0.61643836, 0.95833333, 0.94117647, 0.96      , 0.89156627,
       0.98762036, 1.        , 0.86666667, 0.75      , 0.93115798,
       0.97109827, 1.        , 0.88      , 1.        , 0.95918367,
       0.        , 0.9787234 , 0.        , 1.        , 0.77911647,
       1.        , 0.997543  , 0.76829268, 0.976     , 0.81481481,
       0.97142857, 0.96405229, 0.90909091, 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 0.91219158, 0.83333333, 0.95321421, 1.        ,
       1.        , 0.66666667, 0.90076336, 0.89827255, 0.95652174,
       0.75      , 0.91549296, 0.98550725, 1.        , 0.91176471,
       0.97979798, 1.        , 1.        , 0.87788779, 1.        ,
       1.        , 0.97716895, 0.85714286, 0.96551724, 0.91125402,
       0.91814947, 0.97165992, 0.86569374, 0.99408284, 0.85136932,
       0.99099099, 0.81860465, 1.        , 0.83333333, 0.44444444,
       0.85      , 0.83916084, 0.98956159, 1.        , 0.98013245,
       0.90909091])}in 148.60727548599243s
Epoch 6 with loss: 0.20674872262137275, training auc: 0.9030561161713493, training auc_pr: 0.9306303429118916, best validation AUC: 0.9147732598613045 in 961.941567659378
Eval Performance:{'auc': 0.9116148578527676, 'auc_pr': 0.9258218893050354, 'k': 0.912104725428313}in 82.93278813362122s
Test Performance:{'auc': 0.9048175448342309, 'auc_pr': 0.9243863713266873, 'k': 0.9103466376729461}in 123.62147068977356s
Epoch 7 with loss: 0.19673585247425807, training auc: 0.9187100268050838, training auc_pr: 0.9333783914260886, best validation AUC: 0.9147732598613045 in 916.7791848182678
Eval Performance:{'auc': 0.9028647443551678, 'auc_pr': 0.9276945484810654, 'k': 0.9144151833753063}in 84.0274269580841s
Test Performance:{'auc': 0.8974667154780875, 'auc_pr': 0.924880918295635, 'k': 0.911024938568863}in 131.1831500530243s
Epoch 8 with loss: 0.18853335777918498, training auc: 0.9181438409923726, training auc_pr: 0.9365423607964884, best validation AUC: 0.9147732598613045 in 890.9612948894501
Eval Performance:{'auc': 0.9163974530630765, 'auc_pr': 0.9284748231377444, 'k': 0.9152082744354881}in 76.95907139778137s
Test Performance:{'auc': 0.9032299760997761, 'auc_pr': 0.9251932637497072, 'k': 0.9112830891340425}in 114.49972820281982s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.95522388, 0.99512195, 0.86443825, 0.96666667,
       0.95035461, 1.        , 0.8440367 , 0.95692666, 0.9389313 ,
       0.63013699, 0.9787234 , 0.94117647, 0.97183099, 0.925     ,
       0.98941555, 0.96969697, 0.89655172, 0.78947368, 0.93879206,
       0.95402299, 1.        , 0.91666667, 1.        , 0.95622896,
       0.        , 0.98652291, 0.        , 0.99224806, 0.78571429,
       1.        , 1.        , 0.7483871 , 0.976     , 0.83333333,
       0.97297297, 0.96349206, 0.66666667, 1.        , 1.        ,
       0.66666667, 1.        , 1.        , 1.        , 1.        ,
       0.90909091, 0.91268342, 0.78571429, 0.95537   , 1.        ,
       1.        , 1.        , 0.890625  , 0.87969925, 1.        ,
       0.8       , 0.92193309, 0.98557692, 1.        , 0.92767204,
       0.97959184, 1.        , 1.        , 0.8952381 , 1.        ,
       1.        , 0.97695853, 0.9245283 , 0.96551724, 0.92035398,
       0.92537313, 0.9602122 , 0.86767526, 0.99408284, 0.85424993,
       0.98181818, 0.83673469, 1.        , 0.66666667, 0.42105263,
       0.9       , 0.83969466, 0.98956159, 1.        , 0.97959184,
       0.90909091])}in 114.89517307281494s
Epoch 9 with loss: 0.1832775577051299, training auc: 0.9173809460980217, training auc_pr: 0.9375153185136771, best validation AUC: 0.9163974530630765 in 869.7103641033173
Eval Performance:{'auc': 0.9170960466052714, 'auc_pr': 0.92951518934665, 'k': 0.9163355520917398}in 49.38129806518555s
Test Performance:{'auc': 0.9033103954044294, 'auc_pr': 0.926364559202478, 'k': 0.9125077668154263}in 96.22420954704285s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.94117647, 0.99512195, 0.87022133, 0.93442623,
       0.93708609, 1.        , 0.83018868, 0.95600476, 0.92537313,
       0.58252427, 0.95833333, 0.875     , 0.97260274, 0.91358025,
       0.98717949, 0.9375    , 0.93333333, 0.84210526, 0.93530351,
       0.96      , 1.        , 0.95238095, 1.        , 0.9787234 ,
       0.        , 0.9919571 , 0.        , 0.99212598, 0.73933649,
       0.66666667, 0.99266504, 0.78313253, 0.98387097, 0.78571429,
       1.        , 0.96825397, 0.90909091, 1.        , 1.        ,
       0.66666667, 1.        , 1.        , 1.        , 1.        ,
       1.        , 0.9149243 , 0.83333333, 0.95658934, 1.        ,
       1.        , 1.        , 0.86885246, 0.88631985, 1.        ,
       0.8       , 0.94339623, 0.98058252, 1.        , 0.92578469,
       0.97512438, 1.        , 1.        , 0.88178914, 1.        ,
       0.98039216, 0.97685185, 0.89719626, 0.96551724, 0.92026144,
       0.91103203, 0.96730245, 0.86950053, 1.        , 0.86007365,
       0.98642534, 0.82587065, 1.        , 0.71428571, 0.6       ,
       0.86486486, 0.79338843, 0.9916318 , 1.        , 0.98666667,
       0.90909091])}in 96.68923544883728s
Epoch 10 with loss: 0.17671037192855563, training auc: 0.9261466084929472, training auc_pr: 0.939438952473615, best validation AUC: 0.9170960466052714 in 852.4572894573212
Eval Performance:{'auc': 0.9072590860846061, 'auc_pr': 0.9302954640033292, 'k': 0.9173712898957266}in 65.53950691223145s
Test Performance:{'auc': 0.9051509356809081, 'auc_pr': 0.9268591061714256, 'k': 0.913265471527451}in 125.05865025520325s
Epoch 11 with loss: 0.1713226953148842, training auc: 0.9328163175439054, training auc_pr: 0.9415854011779473, best validation AUC: 0.9170960466052714 in 918.3150458335876
Eval Performance:{'auc': 0.9180992197066667, 'auc_pr': 0.9275905118601748, 'k': 0.9142416492302922}in 64.67864227294922s
Test Performance:{'auc': 0.9182732537119936, 'auc_pr': 0.9265727895051927, 'k': 0.9129929783831678}in 130.53872847557068s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.97709924, 0.99029126, 0.86988171, 0.97520661,
       0.95433071, 1.        , 0.85185185, 0.95672515, 0.91911765,
       0.65546218, 0.9787234 , 1.        , 0.97959184, 0.925     ,
       0.98583828, 0.96774194, 0.93333333, 0.82051282, 0.9362566 ,
       0.95454545, 1.        , 0.95652174, 1.        , 0.97183099,
       0.        , 0.98941799, 0.5       , 1.        , 0.781893  ,
       1.        , 1.        , 0.75903614, 0.98412698, 0.91666667,
       1.        , 0.97444089, 0.90909091, 1.        , 1.        ,
       0.66666667, 1.        , 1.        , 1.        , 1.        ,
       1.        , 0.91413778, 0.92307692, 0.95606079, 1.        ,
       1.        , 0.66666667, 0.88549618, 0.9046729 , 1.        ,
       0.70588235, 0.93680297, 0.98564593, 1.        , 0.92467378,
       0.99492386, 1.        , 1.        , 0.88544892, 1.        ,
       1.        , 0.97940503, 0.94545455, 0.96551724, 0.91812679,
       0.92307692, 0.97297297, 0.86609808, 1.        , 0.86077318,
       0.98642534, 0.83597884, 1.        , 0.88888889, 0.5       ,
       0.9       , 0.8125    , 0.99583333, 1.        , 0.98666667,
       0.90909091])}in 131.05508542060852s
Epoch 12 with loss: 0.16680120231140227, training auc: 0.9364724796293269, training auc_pr: 0.9433085018679302, best validation AUC: 0.9180992197066667 in 889.6983773708344
Eval Performance:{'auc': 0.9277221776565809, 'auc_pr': 0.9305035372451103, 'k': 0.9177365184109773}in 78.0247094631195s
Test Performance:{'auc': 0.9154233230684695, 'auc_pr': 0.9283167182904292, 'k': 0.91507083904963}in 127.81725764274597s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.97709924, 0.99019608, 0.87313073, 0.98360656,
       0.9600639 , 1.        , 0.85185185, 0.95887192, 0.92775665,
       0.57943925, 0.98924731, 1.        , 0.97183099, 0.925     ,
       0.98671553, 0.96774194, 0.875     , 0.81081081, 0.93477391,
       0.97109827, 1.        , 1.        , 1.        , 0.96928328,
       0.        , 0.98941799, 0.        , 1.        , 0.81395349,
       0.66666667, 0.997543  , 0.76646707, 0.976     , 0.88888889,
       0.92307692, 0.97353649, 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       0.90909091, 0.91570036, 0.83870968, 0.95757324, 1.        ,
       1.        , 1.        , 0.90909091, 0.91428571, 0.97777778,
       0.90909091, 0.94160584, 0.98578199, 1.        , 0.92743568,
       0.99492386, 1.        , 1.        , 0.89440994, 1.        ,
       1.        , 0.96      , 0.92982456, 0.96551724, 0.92587776,
       0.91851852, 0.9687924 , 0.86897736, 1.        , 0.86168521,
       0.99099099, 0.84761905, 1.        , 0.83333333, 0.5       ,
       0.87179487, 0.81751825, 0.99583333, 1.        , 0.98648649,
       0.90909091])}in 128.14390969276428s
Epoch 13 with loss: 0.16420386136997314, training auc: 0.9438243048728079, training auc_pr: 0.9441551978966288, best validation AUC: 0.9277221776565809 in 867.8369207382202
Eval Performance:{'auc': 0.9261840624700481, 'auc_pr': 0.9303474823137744, 'k': 0.9173256189228289}in 75.69115376472473s
Test Performance:{'auc': 0.8976268144660081, 'auc_pr': 0.927041307686301, 'k': 0.913349728651419}in 132.00511193275452s
Epoch 14 with loss: 0.1592575976962135, training auc: 0.9348703117809772, training auc_pr: 0.9460194145913949, best validation AUC: 0.9277221776565809 in 861.5257873535156
Eval Performance:{'auc': 0.9224662947692915, 'auc_pr': 0.9317519766957969, 'k': 0.919124281190289}in 80.03431367874146s
Test Performance:{'auc': 0.9090300402863956, 'auc_pr': 0.9292797834404852, 'k': 0.9161419319910049}in 119.07597374916077s
Epoch 15 with loss: 0.15554701402073814, training auc: 0.9444454303059273, training auc_pr: 0.9469775179922906, best validation AUC: 0.9277221776565809 in 881.480792760849
Eval Performance:{'auc': 0.913539477158877, 'auc_pr': 0.9311797752808989, 'k': 0.9184732442879314}in 79.7148597240448s
Test Performance:{'auc': 0.9027199726230853, 'auc_pr': 0.9303469637418985, 'k': 0.9174201467007302}in 106.80332374572754s
Epoch 16 with loss: 0.15253572306462695, training auc: 0.949056379699744, training auc_pr: 0.9478019325465498, best validation AUC: 0.9277221776565809 in 843.5952594280243
Eval Performance:{'auc': 0.9133217602258829, 'auc_pr': 0.9322721598002497, 'k': 0.9196744597229144}in 40.174338817596436s
Test Performance:{'auc': 0.9293691876066962, 'auc_pr': 0.9295400713188787, 'k': 0.9164034495846329}in 128.36457443237305s
Epoch 17 with loss: 0.1507818603515625, training auc: 0.9463031348545412, training auc_pr: 0.9484555224634398, best validation AUC: 0.9277221776565809 in 833.2686567306519
Eval Performance:{'auc': 0.9207004175525269, 'auc_pr': 0.9329483978360383, 'k': 0.9205752981551897}in 78.83630347251892s
Test Performance:{'auc': 0.9078623697707556, 'auc_pr': 0.9293578698040033, 'k': 0.9162652264074043}in 105.51705026626587s
Epoch 18 with loss: 0.1480442580154964, training auc: 0.9524192516038117, training auc_pr: 0.9495250332365327, best validation AUC: 0.9277221776565809 in 844.2364463806152
Eval Performance:{'auc': 0.9230474888003046, 'auc_pr': 0.932896379525593, 'k': 0.9204262331942663}in 56.11240100860596s
Test Performance:{'auc': 0.9189525643316652, 'auc_pr': 0.9290975819256098, 'k': 0.9159017432846432}in 90.87507033348083s
Epoch 19 with loss: 0.14586933093411583, training auc: 0.9421011270268737, training auc_pr: 0.9502826033674735, best validation AUC: 0.9277221776565809 in 806.83744597435
Eval Performance:{'auc': 0.9194611419178441, 'auc_pr': 0.9330004161464835, 'k': 0.9205574312030912}in 79.04388236999512s
Test Performance:{'auc': 0.9094226032814774, 'auc_pr': 0.9303469637418985, 'k': 0.9173700428395314}in 104.14571475982666s
Epoch 20 with loss: 0.14308427919944128, training auc: 0.9566726603550166, training auc_pr: 0.9513298326661269, best validation AUC: 0.9277221776565809 in 894.5991666316986
Eval Performance:{'auc': 0.9302843259845326, 'auc_pr': 0.9337286724927174, 'k': 0.9214270645885599}in 83.45196056365967s
Test Performance:{'auc': 0.913403702366088, 'auc_pr': 0.9293318410161638, 'k': 0.9161732387321675}in 95.9161434173584s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.97709924, 0.99512195, 0.88138862, 0.98360656,
       0.95120062, 1.        , 0.8490566 , 0.96158324, 0.93181818,
       0.58394161, 0.98924731, 0.875     , 0.98630137, 0.9382716 ,
       0.98488319, 0.9375    , 0.86666667, 0.74285714, 0.93391373,
       0.96551724, 1.        , 0.95652174, 1.        , 0.98611111,
       0.        , 0.98666667, 0.        , 1.        , 0.828125  ,
       0.66666667, 0.99509804, 0.80487805, 0.976     , 0.96      ,
       0.97297297, 0.96414343, 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 0.91421515, 0.82758621, 0.95932356, 1.        ,
       1.        , 1.        , 0.87218045, 0.92190476, 1.        ,
       0.8       , 0.95910781, 0.99277108, 1.        , 0.94254937,
       0.98492462, 1.        , 0.85714286, 0.90461538, 1.        ,
       1.        , 0.97482838, 0.89908257, 0.96551724, 0.92551813,
       0.92363636, 0.97560976, 0.86724712, 1.        , 0.86045898,
       0.98630137, 0.83168317, 1.        , 0.76923077, 0.57142857,
       0.9       , 0.84210526, 0.99583333, 1.        , 0.98666667,
       0.90909091])}in 96.28154230117798s
Epoch 21 with loss: 0.14122869050218945, training auc: 0.9547484078947936, training auc_pr: 0.9515897832012538, best validation AUC: 0.9302843259845326 in 966.5277724266052
Eval Performance:{'auc': 0.9113089500528387, 'auc_pr': 0.9320640865584686, 'k': 0.9195029017844111}in 59.1984167098999s
Test Performance:{'auc': 0.919971605930069, 'auc_pr': 0.9291496395012884, 'k': 0.916009112429656}in 113.56101942062378s
Epoch 22 with loss: 0.13968407193819682, training auc: 0.963138787682703, training auc_pr: 0.95252560512771, best validation AUC: 0.9302843259845326 in 899.3970255851746
Eval Performance:{'auc': 0.9288706945996655, 'auc_pr': 0.9348210570120683, 'k': 0.922682561338732}in 84.65776634216309s
Test Performance:{'auc': 0.9169784417924454, 'auc_pr': 0.9311017985892397, 'k': 0.9182583951790658}in 131.71381902694702s
Epoch 23 with loss: 0.13772816433793023, training auc: 0.9547045098381438, training auc_pr: 0.9528226914535691, best validation AUC: 0.9302843259845326 in 900.0840737819672
Eval Performance:{'auc': 0.9287424168799802, 'auc_pr': 0.9324282147315855, 'k': 0.9199220756261557}in 59.62484264373779s
Test Performance:{'auc': 0.9331426310087679, 'auc_pr': 0.9300346182878263, 'k': 0.9170487214814244}in 128.81632041931152s
Epoch 24 with loss: 0.13509394140470596, training auc: 0.9591866022544759, training auc_pr: 0.9543081230828648, best validation AUC: 0.9302843259845326 in 895.6497128009796
Eval Performance:{'auc': 0.9220612371805615, 'auc_pr': 0.9333125260091553, 'k': 0.9209593010429087}in 78.56533026695251s
Test Performance:{'auc': 0.9256081668355464, 'auc_pr': 0.930529165256774, 'k': 0.9176268427055978}in 121.12401604652405s
Epoch 25 with loss: 0.1338156682962463, training auc: 0.960556198224157, training auc_pr: 0.9543081230828648, best validation AUC: 0.9302843259845326 in 921.7583446502686
Eval Performance:{'auc': 0.9135517492182161, 'auc_pr': 0.9314918851435705, 'k': 0.9188507261277553}in 74.15358471870422s
Test Performance:{'auc': 0.9175647018101558, 'auc_pr': 0.9307113667716496, 'k': 0.9178865710589172}in 73.6620180606842s
Epoch 26 with loss: 0.1317367062114534, training auc: 0.9663635639116547, training auc_pr: 0.9555930214422056, best validation AUC: 0.9302843259845326 in 830.5273332595825
Eval Performance:{'auc': 0.9209182192759814, 'auc_pr': 0.932324178110695, 'k': 0.9198318267560335}in 68.58120584487915s
Test Performance:{'auc': 0.9177741042534169, 'auc_pr': 0.9297222728337541, 'k': 0.9166907627028847}in 88.47990036010742s
Epoch 27 with loss: 0.1314203636773995, training auc: 0.9664130833721544, training auc_pr: 0.955102829004538, best validation AUC: 0.9302843259845326 in 885.8911557197571
Eval Performance:{'auc': 0.9112866309293259, 'auc_pr': 0.9328443612151477, 'k': 0.9203879026257022}in 80.62619853019714s
Test Performance:{'auc': 0.9155221151285823, 'auc_pr': 0.9306332804081314, 'k': 0.9177109758151899}in 130.83454966545105s
Epoch 28 with loss: 0.13078315883874894, training auc: 0.9630595318180049, training auc_pr: 0.9552885079582, best validation AUC: 0.9302843259845326 in 881.5679447650909
Eval Performance:{'auc': 0.9347406058913906, 'auc_pr': 0.9328443612151477, 'k': 0.9203566713608644}in 62.28147888183594s
Test Performance:{'auc': 0.9218389864320105, 'auc_pr': 0.9309593091959707, 'k': 0.917980349437983}in 138.75982093811035s
Better models found w.r.t accuracy. Saved it!
Test Performance Per Class:{'f1': array([1.        , 0.96969697, 0.99019608, 0.87877336, 0.98360656,
       0.95686275, 1.        , 0.85981308, 0.96322657, 0.92830189,
       0.61904762, 0.98947368, 0.875     , 0.98630137, 0.925     ,
       0.98850575, 1.        , 0.90322581, 0.77777778, 0.93880903,
       0.97109827, 1.        , 0.95652174, 1.        , 0.9825784 ,
       0.        , 0.98930481, 0.        , 1.        , 0.78991597,
       1.        , 0.997543  , 0.79775281, 0.98412698, 0.92307692,
       1.        , 0.96595408, 1.        , 1.        , 1.        ,
       1.        , 1.        , 1.        , 1.        , 1.        ,
       1.        , 0.91635836, 0.8       , 0.95932008, 1.        ,
       1.        , 1.        , 0.92307692, 0.92424242, 1.        ,
       0.83333333, 0.95522388, 0.98329356, 1.        , 0.93702178,
       0.98461538, 1.        , 0.92307692, 0.86826347, 1.        ,
       1.        , 0.97940503, 0.93103448, 0.96551724, 0.92477302,
       0.9352518 , 0.97400821, 0.87477695, 1.        , 0.86128253,
       0.98630137, 0.83902439, 1.        , 0.76923077, 0.66666667,
       0.92682927, 0.85106383, 0.99791232, 1.        , 0.98666667,
       0.90909091])}in 139.29522109031677s
Epoch 29 with loss: 0.1291439175605774, training auc: 0.9620893137000831, training auc_pr: 0.9563283100987069, best validation AUC: 0.9347406058913906 in 904.2501978874207
Eval Performance:{'auc': 0.9249047990083554, 'auc_pr': 0.9343528922180607, 'k': 0.9221653404024278}in 85.82256507873535s
Test Performance:{'auc': 0.9103013250459603, 'auc_pr': 0.9310237122257217, 'k': 0.9182024158501207}in 136.6177065372467s
Epoch 30 with loss: 0.12798253892433076, training auc: 0.9616033506177949, training auc_pr: 0.9569076284341322, best validation AUC: 0.9347406058913906 in 930.5851192474365
Eval Performance:{'auc': 0.928675320821829, 'auc_pr': 0.9343528922180607, 'k': 0.9221657951290246}in 80.24982047080994s
Test Performance:{'auc': 0.915535869457523, 'auc_pr': 0.9310757698014004, 'k': 0.9182788644619997}in 118.78159713745117s
Epoch 31 with loss: 0.1262129095125766, training auc: 0.9689103259874581, training auc_pr: 0.9575166554021435, best validation AUC: 0.9347406058913906 in 952.6892426013947
Eval Performance:{'auc': 0.9177390406328725, 'auc_pr': 0.9335205992509363, 'k': 0.9212059952157611}in 66.92434096336365s
Test Performance:{'auc': 0.9100070258256177, 'auc_pr': 0.9304771076810953, 'k': 0.9175666560163073}in 111.90630316734314s
Epoch 32 with loss: 0.12606525327478135, training auc: 0.9628221790698539, training auc_pr: 0.9570338901226224, best validation AUC: 0.9347406058913906 in 861.1509623527527
Eval Performance:{'auc': 0.9150121429449894, 'auc_pr': 0.9319080316271328, 'k': 0.9192734798738714}in 73.70253825187683s
Test Performance:{'auc': 0.9162559095796122, 'auc_pr': 0.9307373955594888, 'k': 0.9178508869615561}in 124.4763662815094s
Epoch 33 with loss: 0.12479126330642473, training auc: 0.9723846849621643, training auc_pr: 0.9575909269836083, best validation AUC: 0.9347406058913906 in 783.4236571788788
Eval Performance:{'auc': 0.9308279455990305, 'auc_pr': 0.9336246358718269, 'k': 0.9212817916780419}in 79.18758010864258s
Test Performance:{'auc': 0.9197072739833579, 'auc_pr': 0.9302428485905412, 'k': 0.9172446602072094}in 128.359628200531s
Epoch 34 with loss: 0.12436508885451726, training auc: 0.9646451113689385, training auc_pr: 0.9577468973046843, best validation AUC: 0.9347406058913906 in 867.8315076828003
Eval Performance:{'auc': 0.9305392880399256, 'auc_pr': 0.9337286724927174, 'k': 0.9214079792572364}in 75.5241630077362s
Test Performance:{'auc': 0.918374364136519, 'auc_pr': 0.930971654650043, 'k': 0.9180961129597238}in 118.12584733963013s
Epoch 35 with loss: 0.12385671702169236, training auc: 0.9704822273493239, training auc_pr: 0.9581182552120082, best validation AUC: 0.9347406058913906 in 844.3925449848175
Eval Performance:{'auc': 0.9304590333510444, 'auc_pr': 0.934404910528506, 'k': 0.9222654746544859}in 52.47021722793579s
Test Performance:{'auc': 0.9182398220055843, 'auc_pr': 0.9310237122257217, 'k': 0.9182196079305006}in 67.84862184524536s
Epoch 36 with loss: 0.1221368127777463, training auc: 0.9717167193172433, training auc_pr: 0.9585638847007969, best validation AUC: 0.9347406058913906 in 887.7784039974213
Eval Performance:{'auc': 0.9135847233788033, 'auc_pr': 0.9338327091136079, 'k': 0.9215418579286702}in 59.498249769210815s
Test Performance:{'auc': 0.9208031859263678, 'auc_pr': 0.9306332804081314, 'k': 0.9177184626342755}in 108.9151816368103s
Epoch 37 with loss: 0.12191046741746721, training auc: 0.9724679090050551, training auc_pr: 0.9583633514308421, best validation AUC: 0.9347406058913906 in 824.7993609905243
Eval Performance:{'auc': 0.9281998322305588, 'auc_pr': 0.9340928006658343, 'k': 0.9218660621694865}in 80.55642366409302s
Test Performance:{'auc': 0.9181374262788687, 'auc_pr': 0.9310757698014004, 'k': 0.9182749499665435}in 129.94602847099304s
Epoch 38 with loss: 0.12085780971107028, training auc: 0.9720831048255981, training auc_pr: 0.9593660177806166, best validation AUC: 0.9347406058913906 in 941.8925557136536
Validation performance didn't improve for 10 epochs. Training stops.
